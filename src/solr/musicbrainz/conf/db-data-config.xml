<dataConfig>
    <dataSource name="MyPsql" driver="org.postgresql.Driver" url="jdbc:postgresql://10.24.53.72:5432/musicbrainz_db" user="musicbrainz" password="musicbrainz"/>
    <dataSource name="MyMongo" type="MongoDataSource" database="music-tag" host="10.24.53.72" />
    <document>
        <entity dataSource="MyPsql" name="artist" pk="mbid"
                query="select artist.id as id, concat(artist.gid, '') as mbid, 'artist' as entity_type, artist.name as name,
                              artist.sort_name as sort_name, artist.comment as comment, artist.last_updated as last_updated,
                              gender.name as gender, area.name as area, artist_type.name as type
                      from artist
                           left join gender on artist.gender = gender.id
                           left join area on artist.area = area.id
                           left join artist_type on artist.type = artist_type.id
			where artist.id in (340882,1104429,240559,210221,1261956,442100,1033211,956665,806624,65461,629993,1383132,517370,58976,490404,48588,480395,1062761,43497,445203,1234183,1371360,397233,1077984,877399,1313492,395151,702132,818032,836074,712309,389936,1188883,1038793,1137061,560773,384292,316519,490057,416707,1353184,666765,1233876,242735,940445,211323,909853,911105,1099905,426598,763583,1253950,979809,1083005,427195,418361,553079,921689,1229056,710868,780197,1005903,1259119,403667,720771,118668,1137779,966791,675552,969453,295512,1124006,1342511,1379088,1113049,1371191,127,1066995,661492,464338,1203289,121557,658623,1374118,434963,1082696,1145887,770733,1218485,755376,1364776,842450,298657,440474,1328265,567533,1164464,827598,562931,486777,147613,1033795,309894,337329,1284298,1331640,328756,704867,653954,765739,925336,615215,1036638,1171215,1011053,605672,966574,286724,605342,224040,409429,962362,1086603,615888,635610,1220571,735580,712970,1331512,727606,1274831,701554,799084,1232867,610126,1263525,1338809,785618,466347,416541,1184927,150999,646397,248348,883827,1168197,1362255,228332,59920,582865,1224596,254499,666285,930919,981725,1284225,558137,585748,646400,1222299,914782,994449,1128187,1081773,1125967,856329,1108715,1021755,471340,581115,645014,58862,718801,1184674,730812,709738,310230,448619,469029,1077249,799576,1351930,656467,1264920,1372876,1281675,1315188,464347,110519,855299,841634,868120,1299028,121689,847269,1333471,1385055,293205,125602,451500,1146379,403050,659890,1101934,747016,792334,1276627,1086015,1125933,1088049,1354294,267103,413924,354080,669169,1271462,556011,724123,1316148,288901,819084,322973,787619,396895,876247,11312,570088,1297578,102643,426739,962723,675037,639992,919925,1360903,1139729,374543,801191,110007,371890,980486,1235991,1006877,326976,253303,666042,1050326,924889,1023494,1269764,332612,507544,829056,1141878,949259,1031469,44233,298823,853237,1229959,442097,345564,1333253,567375,1344544,1040483,52269,717605,1111666,444729,644221,553749,736316,761025,1344146,331446,297131,1215197,2791,842830,1208422,740712,651793,1003502,249692,281720,1004071,159808,850088,1339344,964775,281877,518476,498705,995983,361997,684748,206619,289519,1029599,903972,574414,1036535,431132,282505,529682,684086,899363,1208467,1349561,445528,136570,869996,1325367,803362,634155,909555,736434,744458,981275,746123,599417,530111,390764,832626,1304138,1377275,73026,422231,853517,1220995,1348067,826202,1014512,1207130,410166,866548,529619,562210,1063831,543445,346184,988392,520771,1240897,839766,650112,344525,891802,1171913,1254838,565766,888904,399670,428060,1357580,311936,383669,750970,1343623,121331,1244783,154668,701024,1204443,150196,1285650,57197,599513,1030961,954920,1375838,250587,730013,1331884,428265,642609,908899,1122638,625672,1005976,1004677,1208478,754644,963630,1259397,1256530,527729,1318332,1025498,872050,266807,979206,1217259,1190822,504372,761959,506894,1339899,370102,521096,1219438,1321971,495898,959587,976105,1285864,287667,735748,1249755,747968,785201,1225527,501609,765093,957237,892380,1374774,639483,1367431,1079920,998064,1075786,566919,3711,263231,1232506,177427,1001565,63554,708954,241523,126351,231645,1080746,528266,820624,825717,1275108,1166890,574107,983910,1263674,253054,1245089,1055090,903961,521097,243572,511371,554172,422460,661523,411607,526417,368257,655689,846888,322697,719239,1038979,479359,31190,470590,1304729,1000413,668267,556717,1115427,257022,901130,1337517,119233,1113358,770127,1380069,631082,866753,358211,759203,552468,977531,1068631,1313183,438788,1091245,1142182,245446,1022830,373009,1149180,344543,1154913,652465,1208633,497299,288844,290673,139448,577362,723155,576998,1364332,290929,1213786,1217524,311713,1003752,1086156,133579,207055,76930,102999,280071,350263,882695,210331,216002,1108170,717706,945317,582970,1013715,8314,887625,789153,508822,878997,610125,402524,194104,1070060,438407,505614,772810,782022,894794,601181,455778,1141180,200447,312970,1346040,862446,486543,1144248,234666,763938,1188629,327691,1382252,505684,906530,875902,525783,446084,1308404,859552,809114,1050327,1345475,375553,723218,50485,1238687,611528,264077,1301553,1218624,423784,262510,420012,1325699,1173551,233478,210964,1241869,623244,853244,652003,1192828,520215,769481,719502,845310,1077775,885329,1249618,278552,576696,1345317,568924,193470,870820,981278,414585,901674,372556,331669,388540,953440,862988,974152,953722,241324,417143,236067,636064,408656,347562,889277,1007606,125188,1178133,365567,1334760,1157626,804227,1315223,1235525,530017,36854,400958,1207286,771442,440156,132273,1242368,858502,1032337,479860,502596,132560,800215,1307041,1310671,1343490,542814,922871,1276480,356523,1076865,706703,998266,991340,400874,619597,289520,1059654,630515,793043,1142013,730915,857856,883719,1052104,34667,631128,433570,1091783,1018479,991341,810425,1127984,819015,215166,83159,1284920,744084,1295500,511938,213762,460869,455592,558843,252057,49131,443455,879498,788877,1244313,1288363,363910,990209,1227463,1359489,1238716,833552,148368,1062118,376252,1319339,350001,672302,1223086,424189,349458,459258,1252577,1011054,142180,1162402,708484,736747,1012929,561109,1144554,66574,360674,763579,1216691,736743,1079161,417468,134231,964214,1001723,830158,1099567,447088,433097,166380,1168070,595733,1178657,1047310,291484,1338521,1157682,316952,454483,1120651,241375,401270,366443,668634,1036315,1232384,1139724,1235529,751474,473168,1247087,458690,1008603,1290611,631377,382338,496009,863856,386496,1186356,11611,1368646,927669,31612,171615,443647,432526,433327,849969,121699,740756,298188,1384293,251336,556376,1251037,426435,92625,137360,39696,992412,1014684,1149355,360382,752498,1371243,1361936,123742,304708,1374971,255652,239983,313811,3705,1372339,179011,227462,1050635,274057,502754,941349,303659,802811,553878,1209004,520867,740203,1288267,505019,717469,490486,1014868,874382,871183,365544,615277,444221,1203940,1189359,268618,478336,986429,1090374,817400,1386155,864811,740391,1041479,500943,981723,1091033,451983,1234331,379596,1104081,39295,891316,1326656,31494,830400,1318336,577079,842027,549085,822273,668545,222682,857431,1246038,391174,1063642,1126283,56688,324132,904053,1372584,756828,1205551,399736,1044593,1224599,1301537,538877,659271,895807,977271,1041127,184391,840744,442102,132888,314701,639445,1200686,477273,368604,1285991,632260,532112,161270,193512,1122143,808642,840182,780287,816984,570551,600029,667452,772346,520746,589493,863679,560972,11866,605378,789362,341508,336275,100671,342912,1339946,1367214,198568,1116516,1092109,405168,603989,287571,369747,766895,693652,70701,818928,1164007,1242923,700140,619322,978188,763205,174595,900285,981817,876359,895579,1163629,1240323,1335092,890403,1335090,768523,479897,1309393,548829,673489,1383476,1125971,1065275,644029,1169807,462516,537600,1372139,801501,250901,564518,35536,691692,1337339,1013019,977077,844181,702360,1354773,531603,178712,1132845,480427,615281,707375,126238,899925,491420,507912,1292550,612634,9659,1232838,185700,808917,876676,390458,579737,1290107,890433,1330332,316608,391058,110074,399541)"
                deltaQuery="select id from artist where last_updated > '${dataimporter.last_index_time}'" >
            <entity dataSource="MyPsql" name="artist_alias"
                    query="select name from artist_alias where artist ='${artist.id}'" >
                <field name="aliases" column="name" />
            </entity>
            <entity processor="MongoEntityProcessor"
                    query="{'gid':'${artist.mbid}'}"
                    collection="lastfm.artist"
                    datasource="MyMongo" 
                    transformer="script:artistTransformer" 
                    name="artist_count_info">
                <field column="listeners" name="listener_count" mongoField="listeners" />
                <field column="playcount" name="play_count" mongoField="playcount" />
            </entity>
        </entity>

        <entity dataSource="MyPsql" name="release" pk="mbid"
                query="select release.id as id, concat(release.gid, '') as mbid, 'release' as entity_type, release.name as name, release.comment as comment,
                              release.artist_credit as artist_credit, release.quality as quality, release.last_updated as last_updated,
                              release_status.name as status, language.name as language,
                              area.name as area, release_event.date_year as release_year, release_event.date_month as release_month
                      from release
                            join release_event on release_event.release = release.id
                       left join area on release_event.country = area.id
                       left join artist_credit on release.artist_credit = artist_credit.id
                       left join release_status on release.status = release_status.id
                       left join language on release.language = language.id
                            join artist_credit_name on artist_credit_name.artist_credit = release.artist_credit
                           	join artist on artist.id = artist_credit_name.artist
where artist.id in (340882,1104429,240559,210221,1261956,442100,1033211,956665,806624,65461,629993,1383132,517370,58976,490404,48588,480395,1062761,43497,445203,1234183,1371360,397233,1077984,877399,1313492,395151,702132,818032,836074,712309,389936,1188883,1038793,1137061,560773,384292,316519,490057,416707,1353184,666765,1233876,242735,940445,211323,909853,911105,1099905,426598,763583,1253950,979809,1083005,427195,418361,553079,921689,1229056,710868,780197,1005903,1259119,403667,720771,118668,1137779,966791,675552,969453,295512,1124006,1342511,1379088,1113049,1371191,127,1066995,661492,464338,1203289,121557,658623,1374118,434963,1082696,1145887,770733,1218485,755376,1364776,842450,298657,440474,1328265,567533,1164464,827598,562931,486777,147613,1033795,309894,337329,1284298,1331640,328756,704867,653954,765739,925336,615215,1036638,1171215,1011053,605672,966574,286724,605342,224040,409429,962362,1086603,615888,635610,1220571,735580,712970,1331512,727606,1274831,701554,799084,1232867,610126,1263525,1338809,785618,466347,416541,1184927,150999,646397,248348,883827,1168197,1362255,228332,59920,582865,1224596,254499,666285,930919,981725,1284225,558137,585748,646400,1222299,914782,994449,1128187,1081773,1125967,856329,1108715,1021755,471340,581115,645014,58862,718801,1184674,730812,709738,310230,448619,469029,1077249,799576,1351930,656467,1264920,1372876,1281675,1315188,464347,110519,855299,841634,868120,1299028,121689,847269,1333471,1385055,293205,125602,451500,1146379,403050,659890,1101934,747016,792334,1276627,1086015,1125933,1088049,1354294,267103,413924,354080,669169,1271462,556011,724123,1316148,288901,819084,322973,787619,396895,876247,11312,570088,1297578,102643,426739,962723,675037,639992,919925,1360903,1139729,374543,801191,110007,371890,980486,1235991,1006877,326976,253303,666042,1050326,924889,1023494,1269764,332612,507544,829056,1141878,949259,1031469,44233,298823,853237,1229959,442097,345564,1333253,567375,1344544,1040483,52269,717605,1111666,444729,644221,553749,736316,761025,1344146,331446,297131,1215197,2791,842830,1208422,740712,651793,1003502,249692,281720,1004071,159808,850088,1339344,964775,281877,518476,498705,995983,361997,684748,206619,289519,1029599,903972,574414,1036535,431132,282505,529682,684086,899363,1208467,1349561,445528,136570,869996,1325367,803362,634155,909555,736434,744458,981275,746123,599417,530111,390764,832626,1304138,1377275,73026,422231,853517,1220995,1348067,826202,1014512,1207130,410166,866548,529619,562210,1063831,543445,346184,988392,520771,1240897,839766,650112,344525,891802,1171913,1254838,565766,888904,399670,428060,1357580,311936,383669,750970,1343623,121331,1244783,154668,701024,1204443,150196,1285650,57197,599513,1030961,954920,1375838,250587,730013,1331884,428265,642609,908899,1122638,625672,1005976,1004677,1208478,754644,963630,1259397,1256530,527729,1318332,1025498,872050,266807,979206,1217259,1190822,504372,761959,506894,1339899,370102,521096,1219438,1321971,495898,959587,976105,1285864,287667,735748,1249755,747968,785201,1225527,501609,765093,957237,892380,1374774,639483,1367431,1079920,998064,1075786,566919,3711,263231,1232506,177427,1001565,63554,708954,241523,126351,231645,1080746,528266,820624,825717,1275108,1166890,574107,983910,1263674,253054,1245089,1055090,903961,521097,243572,511371,554172,422460,661523,411607,526417,368257,655689,846888,322697,719239,1038979,479359,31190,470590,1304729,1000413,668267,556717,1115427,257022,901130,1337517,119233,1113358,770127,1380069,631082,866753,358211,759203,552468,977531,1068631,1313183,438788,1091245,1142182,245446,1022830,373009,1149180,344543,1154913,652465,1208633,497299,288844,290673,139448,577362,723155,576998,1364332,290929,1213786,1217524,311713,1003752,1086156,133579,207055,76930,102999,280071,350263,882695,210331,216002,1108170,717706,945317,582970,1013715,8314,887625,789153,508822,878997,610125,402524,194104,1070060,438407,505614,772810,782022,894794,601181,455778,1141180,200447,312970,1346040,862446,486543,1144248,234666,763938,1188629,327691,1382252,505684,906530,875902,525783,446084,1308404,859552,809114,1050327,1345475,375553,723218,50485,1238687,611528,264077,1301553,1218624,423784,262510,420012,1325699,1173551,233478,210964,1241869,623244,853244,652003,1192828,520215,769481,719502,845310,1077775,885329,1249618,278552,576696,1345317,568924,193470,870820,981278,414585,901674,372556,331669,388540,953440,862988,974152,953722,241324,417143,236067,636064,408656,347562,889277,1007606,125188,1178133,365567,1334760,1157626,804227,1315223,1235525,530017,36854,400958,1207286,771442,440156,132273,1242368,858502,1032337,479860,502596,132560,800215,1307041,1310671,1343490,542814,922871,1276480,356523,1076865,706703,998266,991340,400874,619597,289520,1059654,630515,793043,1142013,730915,857856,883719,1052104,34667,631128,433570,1091783,1018479,991341,810425,1127984,819015,215166,83159,1284920,744084,1295500,511938,213762,460869,455592,558843,252057,49131,443455,879498,788877,1244313,1288363,363910,990209,1227463,1359489,1238716,833552,148368,1062118,376252,1319339,350001,672302,1223086,424189,349458,459258,1252577,1011054,142180,1162402,708484,736747,1012929,561109,1144554,66574,360674,763579,1216691,736743,1079161,417468,134231,964214,1001723,830158,1099567,447088,433097,166380,1168070,595733,1178657,1047310,291484,1338521,1157682,316952,454483,1120651,241375,401270,366443,668634,1036315,1232384,1139724,1235529,751474,473168,1247087,458690,1008603,1290611,631377,382338,496009,863856,386496,1186356,11611,1368646,927669,31612,171615,443647,432526,433327,849969,121699,740756,298188,1384293,251336,556376,1251037,426435,92625,137360,39696,992412,1014684,1149355,360382,752498,1371243,1361936,123742,304708,1374971,255652,239983,313811,3705,1372339,179011,227462,1050635,274057,502754,941349,303659,802811,553878,1209004,520867,740203,1288267,505019,717469,490486,1014868,874382,871183,365544,615277,444221,1203940,1189359,268618,478336,986429,1090374,817400,1386155,864811,740391,1041479,500943,981723,1091033,451983,1234331,379596,1104081,39295,891316,1326656,31494,830400,1318336,577079,842027,549085,822273,668545,222682,857431,1246038,391174,1063642,1126283,56688,324132,904053,1372584,756828,1205551,399736,1044593,1224599,1301537,538877,659271,895807,977271,1041127,184391,840744,442102,132888,314701,639445,1200686,477273,368604,1285991,632260,532112,161270,193512,1122143,808642,840182,780287,816984,570551,600029,667452,772346,520746,589493,863679,560972,11866,605378,789362,341508,336275,100671,342912,1339946,1367214,198568,1116516,1092109,405168,603989,287571,369747,766895,693652,70701,818928,1164007,1242923,700140,619322,978188,763205,174595,900285,981817,876359,895579,1163629,1240323,1335092,890403,1335090,768523,479897,1309393,548829,673489,1383476,1125971,1065275,644029,1169807,462516,537600,1372139,801501,250901,564518,35536,691692,1337339,1013019,977077,844181,702360,1354773,531603,178712,1132845,480427,615281,707375,126238,899925,491420,507912,1292550,612634,9659,1232838,185700,808917,876676,390458,579737,1290107,890433,1330332,316608,391058,110074,399541)">
            
            <entity dataSource="MyPsql" name="release_alias"
                    query="select name from release_alias where release ='${release.id}'" >
                <field name="aliases" column="name" />
            </entity>
            <entity dataSource="MyPsql" name="release_artist"
                    query="select artist.id as id, concat(artist.gid, '') as mbid, artist.name as name
                          from artist_credit_name as acn 
                               join artist on artist.id = acn.artist
                          where acn.artist_credit = '${release.artist_credit}'
                          order by acn.position">
                <entity dataSource="MyPsql" name="release_artist_alias"
                        query="select name from artist_alias where artist ='${release_artist.id}'">
                    <field name="artists_aliases" column="name"/>
                </entity>
                <field name="artists_mbid" column="mbid"/>
                <field name="artists_name" column="name"/>
            </entity>

            <entity processor="MongoEntityProcessor"
                    query="{'gid':'${release.mbid}'}"
                    collection="lastfm.album"
                    datasource="MyMongo" 
                    name="release_count_info">
                <field column="listeners" name="listener_count" mongoField="listeners" />
                <field column="playcount" name="play_count" mongoField="playcount" />
            </entity>

        </entity>

        <entity dataSource="MyPsql" name="recording" pk="mbid"
                query="select recording.id as id, concat(recording.gid, '') as mbid, 'recording' as entity_type, recording.name as name, recording.artist_credit as artist_credit,
                              recording.length as length, recording.comment as comment, recording.last_updated as last_updated, recording.video as is_video
                      from recording
                           left join artist_credit on recording.artist_credit = artist_credit.id
                           join artist_credit_name on artist_credit_name.artist_credit = recording.artist_credit
                           join artist on artist.id = artist_credit_name.artist
where artist.id in (340882,1104429,240559,210221,1261956,442100,1033211,956665,806624,65461,629993,1383132,517370,58976,490404,48588,480395,1062761,43497,445203,1234183,1371360,397233,1077984,877399,1313492,395151,702132,818032,836074,712309,389936,1188883,1038793,1137061,560773,384292,316519,490057,416707,1353184,666765,1233876,242735,940445,211323,909853,911105,1099905,426598,763583,1253950,979809,1083005,427195,418361,553079,921689,1229056,710868,780197,1005903,1259119,403667,720771,118668,1137779,966791,675552,969453,295512,1124006,1342511,1379088,1113049,1371191,127,1066995,661492,464338,1203289,121557,658623,1374118,434963,1082696,1145887,770733,1218485,755376,1364776,842450,298657,440474,1328265,567533,1164464,827598,562931,486777,147613,1033795,309894,337329,1284298,1331640,328756,704867,653954,765739,925336,615215,1036638,1171215,1011053,605672,966574,286724,605342,224040,409429,962362,1086603,615888,635610,1220571,735580,712970,1331512,727606,1274831,701554,799084,1232867,610126,1263525,1338809,785618,466347,416541,1184927,150999,646397,248348,883827,1168197,1362255,228332,59920,582865,1224596,254499,666285,930919,981725,1284225,558137,585748,646400,1222299,914782,994449,1128187,1081773,1125967,856329,1108715,1021755,471340,581115,645014,58862,718801,1184674,730812,709738,310230,448619,469029,1077249,799576,1351930,656467,1264920,1372876,1281675,1315188,464347,110519,855299,841634,868120,1299028,121689,847269,1333471,1385055,293205,125602,451500,1146379,403050,659890,1101934,747016,792334,1276627,1086015,1125933,1088049,1354294,267103,413924,354080,669169,1271462,556011,724123,1316148,288901,819084,322973,787619,396895,876247,11312,570088,1297578,102643,426739,962723,675037,639992,919925,1360903,1139729,374543,801191,110007,371890,980486,1235991,1006877,326976,253303,666042,1050326,924889,1023494,1269764,332612,507544,829056,1141878,949259,1031469,44233,298823,853237,1229959,442097,345564,1333253,567375,1344544,1040483,52269,717605,1111666,444729,644221,553749,736316,761025,1344146,331446,297131,1215197,2791,842830,1208422,740712,651793,1003502,249692,281720,1004071,159808,850088,1339344,964775,281877,518476,498705,995983,361997,684748,206619,289519,1029599,903972,574414,1036535,431132,282505,529682,684086,899363,1208467,1349561,445528,136570,869996,1325367,803362,634155,909555,736434,744458,981275,746123,599417,530111,390764,832626,1304138,1377275,73026,422231,853517,1220995,1348067,826202,1014512,1207130,410166,866548,529619,562210,1063831,543445,346184,988392,520771,1240897,839766,650112,344525,891802,1171913,1254838,565766,888904,399670,428060,1357580,311936,383669,750970,1343623,121331,1244783,154668,701024,1204443,150196,1285650,57197,599513,1030961,954920,1375838,250587,730013,1331884,428265,642609,908899,1122638,625672,1005976,1004677,1208478,754644,963630,1259397,1256530,527729,1318332,1025498,872050,266807,979206,1217259,1190822,504372,761959,506894,1339899,370102,521096,1219438,1321971,495898,959587,976105,1285864,287667,735748,1249755,747968,785201,1225527,501609,765093,957237,892380,1374774,639483,1367431,1079920,998064,1075786,566919,3711,263231,1232506,177427,1001565,63554,708954,241523,126351,231645,1080746,528266,820624,825717,1275108,1166890,574107,983910,1263674,253054,1245089,1055090,903961,521097,243572,511371,554172,422460,661523,411607,526417,368257,655689,846888,322697,719239,1038979,479359,31190,470590,1304729,1000413,668267,556717,1115427,257022,901130,1337517,119233,1113358,770127,1380069,631082,866753,358211,759203,552468,977531,1068631,1313183,438788,1091245,1142182,245446,1022830,373009,1149180,344543,1154913,652465,1208633,497299,288844,290673,139448,577362,723155,576998,1364332,290929,1213786,1217524,311713,1003752,1086156,133579,207055,76930,102999,280071,350263,882695,210331,216002,1108170,717706,945317,582970,1013715,8314,887625,789153,508822,878997,610125,402524,194104,1070060,438407,505614,772810,782022,894794,601181,455778,1141180,200447,312970,1346040,862446,486543,1144248,234666,763938,1188629,327691,1382252,505684,906530,875902,525783,446084,1308404,859552,809114,1050327,1345475,375553,723218,50485,1238687,611528,264077,1301553,1218624,423784,262510,420012,1325699,1173551,233478,210964,1241869,623244,853244,652003,1192828,520215,769481,719502,845310,1077775,885329,1249618,278552,576696,1345317,568924,193470,870820,981278,414585,901674,372556,331669,388540,953440,862988,974152,953722,241324,417143,236067,636064,408656,347562,889277,1007606,125188,1178133,365567,1334760,1157626,804227,1315223,1235525,530017,36854,400958,1207286,771442,440156,132273,1242368,858502,1032337,479860,502596,132560,800215,1307041,1310671,1343490,542814,922871,1276480,356523,1076865,706703,998266,991340,400874,619597,289520,1059654,630515,793043,1142013,730915,857856,883719,1052104,34667,631128,433570,1091783,1018479,991341,810425,1127984,819015,215166,83159,1284920,744084,1295500,511938,213762,460869,455592,558843,252057,49131,443455,879498,788877,1244313,1288363,363910,990209,1227463,1359489,1238716,833552,148368,1062118,376252,1319339,350001,672302,1223086,424189,349458,459258,1252577,1011054,142180,1162402,708484,736747,1012929,561109,1144554,66574,360674,763579,1216691,736743,1079161,417468,134231,964214,1001723,830158,1099567,447088,433097,166380,1168070,595733,1178657,1047310,291484,1338521,1157682,316952,454483,1120651,241375,401270,366443,668634,1036315,1232384,1139724,1235529,751474,473168,1247087,458690,1008603,1290611,631377,382338,496009,863856,386496,1186356,11611,1368646,927669,31612,171615,443647,432526,433327,849969,121699,740756,298188,1384293,251336,556376,1251037,426435,92625,137360,39696,992412,1014684,1149355,360382,752498,1371243,1361936,123742,304708,1374971,255652,239983,313811,3705,1372339,179011,227462,1050635,274057,502754,941349,303659,802811,553878,1209004,520867,740203,1288267,505019,717469,490486,1014868,874382,871183,365544,615277,444221,1203940,1189359,268618,478336,986429,1090374,817400,1386155,864811,740391,1041479,500943,981723,1091033,451983,1234331,379596,1104081,39295,891316,1326656,31494,830400,1318336,577079,842027,549085,822273,668545,222682,857431,1246038,391174,1063642,1126283,56688,324132,904053,1372584,756828,1205551,399736,1044593,1224599,1301537,538877,659271,895807,977271,1041127,184391,840744,442102,132888,314701,639445,1200686,477273,368604,1285991,632260,532112,161270,193512,1122143,808642,840182,780287,816984,570551,600029,667452,772346,520746,589493,863679,560972,11866,605378,789362,341508,336275,100671,342912,1339946,1367214,198568,1116516,1092109,405168,603989,287571,369747,766895,693652,70701,818928,1164007,1242923,700140,619322,978188,763205,174595,900285,981817,876359,895579,1163629,1240323,1335092,890403,1335090,768523,479897,1309393,548829,673489,1383476,1125971,1065275,644029,1169807,462516,537600,1372139,801501,250901,564518,35536,691692,1337339,1013019,977077,844181,702360,1354773,531603,178712,1132845,480427,615281,707375,126238,899925,491420,507912,1292550,612634,9659,1232838,185700,808917,876676,390458,579737,1290107,890433,1330332,316608,391058,110074,399541)">		
	    <entity dataSource="MyPsql" name="recording_alias"
                    query="select name from recording_alias where recording ='${recording.id}'" >
                <field name="aliases" column="name" />
            </entity>
            <entity dataSource="MyPsql" name="recording_artist"
                    query="select artist.id as id, concat(artist.gid, '') as mbid, artist.name as name
                          from artist_credit_name as acn 
                               join artist on artist.id = acn.artist
                          where acn.artist_credit = '${recording.artist_credit}'
                          order by acn.position">
                <entity dataSource="MyPsql" name="recording_artist_alias"
                        query="select name from artist_alias where artist ='${recording_artist.id}'">
                    <field name="artists_aliases" column="name"/>
                </entity>
                <field name="artists_mbid" column="mbid"/>
                <field name="artists_name" column="name"/>
            </entity>
            <entity dataSource="MyPsql" name="recording_release"
                    query="select release.id as id, concat(release.gid, '') as mbid, release.name as name,
                          area.name as area, release_event.date_year as release_year, release_event.date_month as release_month	
                          from track
                               join medium on medium.id = track.medium
                               join release on release.id = medium.release
			       join release_event on release_event.release = release.id
		          left join area on release_event.country = area.id
                          where track.recording = '${recording.id}'">
                <entity dataSource="MyPsql" name="recording_release_alias"
                        query="select name from release_alias where release ='${recording_release.id}'">
                    <field name="releases_aliases" column="name"/>
                </entity>
                <field name="releases_mbid" column="mbid"/>
                <field name="releases_name" column="name"/>
                <field name="releases_area" column="area"/>
                <field name="releases_year" column="release_year"/>
                <field name="releases_month" column="release_month"/>
            </entity>
            <entity processor="MongoEntityProcessor"
                    query="{'gid':'${recording.mbid}'}"
                    collection="lastfm.track"
                    datasource="MyMongo" 
                    name="recording_count_info">
                <field column="listeners" name="listener_count" mongoField="listeners" />
                <field column="playcount" name="play_count" mongoField="playcount" />
            </entity>
        </entity>
    </document>
  <script><![CDATA[
    function artistTransformer(row){
        row.put('listeners', '0');
        row.put('playcount', '0');
        if(row.get('stats') !== null && row.get('stats')){
            var stats = row.get('stats');
            if(stats.get('listeners') !== null){
               row.put('listeners', stats.get('listeners'));
            }
            if(stats.get('playcount') !== null){
               row.put('playcount', stats.get('playcount'));
            }
        }
        return row;
    }
  ]]></script>

</dataConfig>
